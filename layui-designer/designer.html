<html>

<head>
    <meta charset="utf-8"/>
    <!-- <script src="/lib/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="/lib/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css">
    <script src="/layuiadmin/layui/layui.js"></script> -->
    <script src="./jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="./font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./layui/css/layui.css">
    <script src="./layui/layui.js"></script>
    <script src="../dist/layui-designer/designer.js" type="module"></script>
    <link rel="stylesheet" href="./style.css">
    <script src="../dist/designer/concrete/UnitConvert.js" type="module"></script>
    <style>
        .qrcode-box{
            color: transparent !important;
        }
        .qrcode-box::after{
            color:black;
            content: attr(alt);
            width: 100%;
            height: 100%;
            position: absolute;
            top:0;
            left: 0;
            text-align: center;
            background-image: url('./icon/qrcode.png');
            background-size: 100% 100%;
        }
        .text-box {
            background-color: rgba(255, 235, 205, 0.329);
        }

        .element-box {
            background-image: linear-gradient(-45deg, rgba(0, 0, 0, 0.1), rgba(255, 255, 255, 0.1), rgba(0, 0, 0, 0.1));
        }

        .page-box{
            transform-origin: 50% 0;
            background-color: white;
        }
        .designer-dom {
            display: flex;
            justify-content: center;
            width: calc(100vw - 360px);
            height: calc(100vh - 40px);
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.1);
        }
        .popup {
            position: absolute;
            width: 360px;
            position: fixed;
            right: 0;
            top: 40px;
            height: calc(100vh - 40px);
            overflow-y: auto;
            background-color: white;
        }
    </style>
</head>

<body>
    <div class="main">
        <div class="header-btns layui-form" lay-filter="toolbar">
            <span class="toolbar-dom popup-dom"></span>
            <div class="layui-btn-group">
                <div style="cursor:pointer" title="保存" onclick="save(0)">
                    <svg t="1631084660018" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="4250" width="24" height="24">
                        <path
                            d="M949.248 197.632q7.168 8.192 8.192 18.944t1.024 16.896l0 549.888q0 48.128-32.768 80.896t-87.04 32.768l-591.872 0q-55.296 0-87.552-27.648t-32.256-83.968l0-599.04q0-55.296 32.256-88.576t87.552-33.28l542.72 0q10.24 0 20.48 2.56t14.336 6.656zM768 160.768q-2.048-31.744-33.792-31.744l-446.464 0q-15.36-1.024-24.576 8.192t-9.216 21.504l0 166.912q0 10.24 4.608 20.992t12.8 19.456 18.944 14.336 23.04 5.632l389.12 0q27.648 0 46.592-16.384t18.944-49.152l0-159.744zM768 621.568q0-44.032-45.056-45.056l-422.912 0q-23.552 0-34.816 12.288t-11.264 32.768l0 149.504 514.048 0 0-149.504z"
                            p-id="4251" fill="#d4237a"></path>
                    </svg>
                </div>
            </div>
            <div class="layui-btn-group">
                <button type="button" id="btnAddText"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="添加文本"
                    onclick="addElement('text')">
                    <i class="fa fa-font"></i>
                </button>
                <button type="button" id="btnAddQrcode"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="添加二维码"
                    onclick="addElement('qrcode')">
                    <i class="fa fa-qrcode"></i>
                </button>
                <button type="button" id="btnAddLine"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="添加直线"
                    onclick="addElement('line')">
                    <img src="./icon/line.png" width="10">
                </button>
                <button type="button" id="btnBold"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="删除元素"
                    onclick="removeElement()">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="header-btn-select toolStyle elem-text">
                <select name="selFont" id="selFont" lay-verify="required" lay-filter="selFont" class="toolInput">
                    <option value="FZShuTi">方正舒体</option>
                    <option value="FZYaoti">方正姚体</option>
                    <option value="FangSong">仿宋</option>
                    <option value="FangSong_GB2312">仿宋_GB2312</option>
                    <option value="SimHei">黑体</option>
                    <option value="STCaiyun">华文彩云</option>
                    <option value="STFangsong">华文仿宋</option>
                    <option value="STHupo">华文琥珀</option>
                    <option value="STKaiti">华文楷体</option>
                    <option value="STLiti">华文隶书</option>
                    <option value="STSong">华文宋体</option>
                    <option value="STXihei">华文细黑</option>
                    <option value="STHeiti">华文黑体</option>
                    <option value="STXinwei">华文新魏</option>
                    <option value="STXingkai">华文行楷</option>
                    <option value="STZhongsong">华文中宋</option>
                    <option value="KaiTi">楷体</option>
                    <option value="KaiTi_GB2312">楷体_GB2312</option>
                    <option value="LiSu">隶书</option>
                    <option value="SimSun">宋体</option>
                    <option value="YaHei">微软雅黑</option>
                    <option value="JhengHei">微软正黑体</option>
                    <option value="PMingLiU">新细明体</option>
                    <option value="MingLiU">细明体</option>
                    <option value="DFKai-SB">标楷体</option>
                    <!--<option value="3">微软雅黑 Light</option>-->
                    <option value="NSimSun">新宋体</option>
                    <option value="YouYuan">幼圆</option>
                </select>

            </div>
            <div class="header-btn-select toolStyle elem-text" style="width:80px;margin-right:10px;">
                <select name="selSize" id="selSize" lay-verify="required" lay-filter="selSize" class="toolInput">
                    <option value="42">初号</option>
                    <option value="36">小初</option>
                    <option value="26">一号</option>
                    <option value="24">小一</option>
                    <option value="22">二号</option>
                    <option value="18">小二</option>
                    <option value="16">三号</option>
                    <option value="15">小三</option>
                    <option value="14">四号</option>
                    <option value="12">小四</option>
                    <option value="10.5">五号</option>
                    <option value="9">小五</option>
                    <option value="7.5">六号</option>
                    <option value="6.5">小六</option>
                    <option value="5.5">七号</option>
                    <option value="5">八号</option>
                    <option value="6">6</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="14">14</option>
                    <option value="16">16</option>
                    <option value="18">18</option>
                    <option value="20">20</option>
                    <option value="22">22</option>
                    <option value="24">24</option>
                    <option value="26">26</option>
                    <option value="28">28</option>
                    <option value="36">36</option>
                    <option value="48">48</option>
                    <option value="72">72</option>
                </select>
            </div>
            <div class="layui-btn-group toolStyle elem-text">

                <button type="button" id="btnBold"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="粗体"
                    onclick="switchBold()">
                    <i class="fa fa-bold"></i>
                </button>
                <button type="button" id="btnItalics"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="斜体"
                    onclick="switchItalic()">
                    <i class="fa fa-italic"></i>
                </button>
                <button type="button" id="btnUnderline"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="下划线"
                    onclick="switchUnderline()">
                    <i class="fa fa-underline"></i>
                </button>
                <button type="button" id="btnBold"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="自动换行"
                    onclick="switchWrapping()">
                    <img src="./icon/text-wrapping.png" width="15">
                </button>
            </div>
            <div class="layui-btn-group toolStyle elem-text">
                <button type="button" id="textLeft"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="文字左对齐"
                    onclick="setHorizentalAlign('left')">
                    <i class="fa fa-align-left"></i>
                </button>
                <button type="button" id="textCenter"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="文字水平居中"
                    onclick="setHorizentalAlign('center')">
                    <i class="fa fa-align-center"></i>
                </button>
                <button type="button" id="textRight"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="文字右对齐"
                    onclick="setHorizentalAlign('right')">
                    <i class="fa fa-align-right"></i>
                </button>
            </div>
            <div class="layui-btn-group toolStyle elem-text">
                <button type="button" id="textLeft"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="文字顶对齐"
                    onclick="setVerticalAlign('top')">
                    <img src="./icon/vertical-top.png" width="15">
                </button>
                <button type="button" id="textCenter"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="文字垂直居中"
                    onclick="setVerticalAlign('center')">
                    <img src="./icon/vertical-center.png" width="15">
                </button>
                <button type="button" id="textRight"
                    class="layui-btn layui-btn-primary layui-btn-sm operation-btn toolInput" title="文字底对齐"
                    onclick="setVerticalAlign('bottom')">
                    <img src="./icon/vertical-bottom.png" width="15">
                </button>
            </div>
            <div class="tab-btn">
                <!-- <span class="tab-btn-item tab-btn-active" onclick="tiaozhuan(1)">编辑</span> -->
                <span class="tab-btn-item" onclick="previewDocument()">预览</span>
            </div>
            <div class="layui-btn-group" style="float: right;margin-right:20px;">
                <button class="layui-btn layui-btn-sm layui-btn-primary" onclick="setDesignerScaleDown()">-</button>
                <div class="layui-input-inline" style="width: 50px;">
                    <input class="layui-input" style="height:30px;font-size:12px;border-color: #d2d2d2;" type="text" name="scale" onmousewheel="event.deltaY > 0 ? setDesignerScaleDown() : setDesignerScaleUp()" onchange="setDesignerScale(Number.parseFloat(event.target.value))">
                </div>
                <button class="layui-btn layui-btn-sm layui-btn-primary" onclick="setDesignerScaleUp()">+</button>
            </div>
        </div>
        <div class="designer-dom">

        </div>
        <div class="layui-form popup" lay-filter="popup">
            <div class="layui-collapse">
                <div class="layui-colla-item elem-text elem-qrcode" >
                    <h2 class="layui-colla-title">文本</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item layui-form-text" style="display: flex;">
                            <label style="width: 50px;">内容</label>
                            <textarea class="layui-textarea" name="content" onchange="setContent(event.target.value)" id="textareaContent"></textarea>
                        </div>
                        <div class="layui-form-item">
                            <button class="layui-btn layui-btn-sm" style="margin-left:43px;" onclick="insertFieldToContent()">插入域</button>
                        </div>
                        <div class="layui-form-item elem-text">
                            <label style="margin-right:5px;vertical-align: bottom;">自适应</label>
                            <div class="layui-inline" style="height: 25px;">
                                <input name="fitContentWidth" lay-filter="fitContentWidth" type="checkbox"
                                    class="layui-input-inline" title="适应宽度" lay-skin="primary">
                                <input name="fitContentHeight" lay-filter="fitContentHeight" type="checkbox"
                                    class="layui-input-inline" title="适应高度" lay-skin="primary">
                            </div>
                        </div>
                        
                    </div>
                </div>
                <div class="layui-colla-item elem-line">
                    <h2 class="layui-colla-title">线条</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item">
                            <label>样式</label>
                            <input name="lineWidthValue" autocomplete="off" class="layui-input"
                                style="width:40px;display:inline;margin:0 10px;"
                                onchange="setLineWidth(Number.parseFloat(event.target.value))">
                            <div style="width:67px;display:inline-block;">
                                <select name="selLineWidthUnit" lay-filter="selLineWidthUnit"
                                    id="selLineWidthUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <select name="selLineStyle" lay-filter="selLineStyle" id="selLineStyle">
                                    <option value="solid">实线</option>
                                    <option value="dashed">虚线</option>
                                    <option value="dotted">点</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <input class="layui-input" name="color" style="position:absolute;width:50px;z-index:2" onchange="seColor(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selColor" style="position:absolute;z-index:1;">
                                    <option value=""></option>
                                    <option value="transparent">透明</option>
                                    <option value="black">黑色</option>
                                    <option value="gray">灰色</option>
                                    <option value="red">红色</option>
                                    <option value="yellow">黄色</option>
                                    <option value="blue">蓝色</option>
                                    <option value="green">绿色</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-text elem-page">
                    <h2 class="layui-colla-title">颜色</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item elem-text elem-qrcode">
                            <label style="margin-right:5px;">文本</label>
                            <div class="layui-inline">
                                <input class="layui-input" name="color" style="position:absolute;width:calc(100% - 30px);z-index:2" onchange="setColor(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selColor" style="position:absolute;z-index:1;">
                                    <option value=""></option>
                                    <option value="transparent">透明</option>
                                    <option value="black">黑色</option>
                                    <option value="gray">灰色</option>
                                    <option value="red">红色</option>
                                    <option value="yellow">黄色</option>
                                    <option value="blue">蓝色</option>
                                    <option value="green">绿色</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label style="margin-right:5px;">背景</label>
                            <div class="layui-inline">
                                <input class="layui-input" name="backgroundColor" style="position:absolute;width:calc(100% - 30px);z-index:2" onchange="setBackgroundColor(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selBackgroundColor" style="position:absolute;z-index:1;">
                                    <option value=""></option>
                                    <option value="transparent">透明</option>
                                    <option value="white">白色</option>
                                    <option value="black">黑色</option>
                                    <option value="gray">灰色</option>
                                    <option value="red">红色</option>
                                    <option value="yellow">黄色</option>
                                    <option value="blue">蓝色</option>
                                    <option value="green">绿色</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-qrcode">
                    <h2 class="layui-colla-title">大小</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item">
                            <label>大小</label>
                            <div class="layui-inline" style="width: 100px;">
                                <input class="layui-input" name="widthValue" style="position:absolute;width:calc(100% - 30px);z-index:2" onchange="setWidth(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selWidthValue" style="position:absolute;z-index:1;">
                                    <option value="150"></option>
                                    <option value="100">100</option>
                                    <option value="150">150</option>
                                    <option value="300">300</option>
                                </select>
                            </div>
                            <div style="width:70px;display:inline-block;">
                                <select name="selWidthUnit" lay-filter="selWidthUnit" id="selWidthUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-text elem-page">
                    <h2 class="layui-colla-title">大小</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item">
                            <label>宽度</label>
                            <input name="widthValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setWidth(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selWidthUnit" lay-filter="selWidthUnit" id="selWidthUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>高度</label>
                            <input name="heightValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setHeight(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selHeightUnit" lay-filter="selHeightUnit" id="selHeightUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-line">
                    <h2 class="layui-colla-title">位置</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item">
                            <label>X1</label>
                            <input name="x1Value" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setX1(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selX1Unit" lay-filter="selX1Unit" id="selX1Unit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>Y1</label>
                            <input name="y1Value" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setY1(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selY1Unit" lay-filter="selY1Unit" id="selY1Unit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>X2</label>
                            <input name="x2Value" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setX2(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selX2Unit" lay-filter="selX2Unit" id="selX2Unit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>Y2</label>
                            <input name="y2Value" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setY2(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selY2Unit" lay-filter="selY2Unit" id="selY2Unit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-text elem-qrcode">
                    <h2 class="layui-colla-title">位置</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item">
                            <label>X</label>
                            <input name="xValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setX(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selXUnit" lay-filter="selXUnit" id="selXUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>Y</label>
                            <input name="yValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setY(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selYUnit" lay-filter="selYUnit" id="selYUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-text">
                    <h2 class="layui-colla-title">边框</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item">
                            <label>上</label>
                            <input name="borderTopWidthValue" autocomplete="off" class="layui-input"
                                style="width:40px;display:inline;margin:0 10px;"
                                onchange="setBorderTopWidth(Number.parseFloat(event.target.value))">
                            <div style="width:67px;display:inline-block;">
                                <select name="selBorderTopWidthUnit" lay-filter="selBorderTopWidthUnit"
                                    id="selBorderTopWidthUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <select name="selBorderTopStyle" lay-filter="selBorderTopStyle" id="selBorderTopStyle">
                                    <option value="">无</option>
                                    <option value="solid">实线</option>
                                    <option value="dashed">虚线</option>
                                    <option value="dotted">点</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <input class="layui-input" name="borderTopColor" style="position:absolute;width:50px;z-index:2" onchange="setBorderTopColor(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selBorderTopColor" style="position:absolute;z-index:1;">
                                    <option value=""></option>
                                    <option value="transparent">透明</option>
                                    <option value="black">黑色</option>
                                    <option value="gray">灰色</option>
                                    <option value="red">红色</option>
                                    <option value="yellow">黄色</option>
                                    <option value="blue">蓝色</option>
                                    <option value="green">绿色</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>下</label>
                            <input name="borderBottomWidthValue" autocomplete="off" class="layui-input"
                                style="width:40px;display:inline;margin:0 10px;"
                                onchange="setBorderBottomWidth(Number.parseFloat(event.target.value))">
                            <div style="width:67px;display:inline-block;">
                                <select name="selBorderBottomWidthUnit" lay-filter="selBorderBottomWidthUnit"
                                    id="selBorderBottomWidthUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <select name="selBorderBottomStyle" lay-filter="selBorderBottomStyle"
                                    id="selBorderBottomStyle">
                                    <option value="">无</option>
                                    <option value="solid">实线</option>
                                    <option value="dashed">虚线</option>
                                    <option value="dotted">点</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <input class="layui-input" name="borderBottomColor" style="position:absolute;width:50px;z-index:2" onchange="setBorderBottomColor(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selBorderBottomColor" style="position:absolute;z-index:1;">
                                    <option value=""></option>
                                    <option value="transparent">透明</option>
                                    <option value="black">黑色</option>
                                    <option value="gray">灰色</option>
                                    <option value="red">红色</option>
                                    <option value="yellow">黄色</option>
                                    <option value="blue">蓝色</option>
                                    <option value="green">绿色</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>左</label>
                            <input name="borderLeftWidthValue" autocomplete="off" class="layui-input"
                                style="width:40px;display:inline;margin:0 10px;"
                                onchange="setBorderLeftWidth(Number.parseFloat(event.target.value))">
                            <div style="width:67px;display:inline-block;">
                                <select name="selBorderLeftWidthUnit" lay-filter="selBorderLeftWidthUnit"
                                    id="selBorderLeftWidthUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <select name="selBorderLeftStyle" lay-filter="selBorderLeftStyle"
                                    id="selBorderLeftStyle">
                                    <option value="">无</option>
                                    <option value="solid">实线</option>
                                    <option value="dashed">虚线</option>
                                    <option value="dotted">点</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <input class="layui-input" name="borderLeftColor" style="position:absolute;width:50px;z-index:2" onchange="setBorderLeftColor(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selBorderLeftColor" style="position:absolute;z-index:1;">
                                    <option value=""></option>
                                    <option value="transparent">透明</option>
                                    <option value="black">黑色</option>
                                    <option value="gray">灰色</option>
                                    <option value="red">红色</option>
                                    <option value="yellow">黄色</option>
                                    <option value="blue">蓝色</option>
                                    <option value="green">绿色</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>右</label>
                            <input name="borderRightWidthValue" autocomplete="off" class="layui-input"
                                style="width:40px;display:inline;margin:0 10px;"
                                onchange="setBorderRightWidth(Number.parseFloat(event.target.value))">
                            <div style="width:67px;display:inline-block;">
                                <select name="selBorderRightWidthUnit" lay-filter="selBorderRightWidthUnit"
                                    id="selBorderRightWidthUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <select name="selBorderRightStyle" lay-filter="selBorderRightStyle"
                                    id="selBorderRightStyle">
                                    <option value="">无</option>
                                    <option value="solid">实线</option>
                                    <option value="dashed">虚线</option>
                                    <option value="dotted">点</option>
                                </select>
                            </div>
                            <div style="width:75px;display:inline-block;">
                                <input class="layui-input" name="borderRightColor" style="position:absolute;width:50px;z-index:2" onchange="setBorderRightColor(event.target.value)"/>
                                <select type="text" lay-search="" lay-filter="selBorderRightColor" style="position:absolute;z-index:1;">
                                    <option value=""></option>
                                    <option value="transparent">透明</option>
                                    <option value="black">黑色</option>
                                    <option value="gray">灰色</option>
                                    <option value="red">红色</option>
                                    <option value="yellow">黄色</option>
                                    <option value="blue">蓝色</option>
                                    <option value="green">绿色</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-text">
                    <h2 class="layui-colla-title">内衬</h2>
                    <div class="layui-colla-content layui-show">
                        <div class="layui-form-item">
                            <label>上</label>
                            <input name="paddingTopValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setPaddingTop(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selPaddingTopUnit" lay-filter="selPaddingTopUnit" id="selPaddingTopUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>下</label>
                            <input name="paddingBottomValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setPaddingBottom(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selPaddingBottomUnit" lay-filter="selPaddingBottomUnit"
                                    id="selPaddingBottomUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>左</label>
                            <input name="paddingLeftValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setPaddingLeft(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selPaddingLeftUnit" lay-filter="selPaddingLeftUnit"
                                    id="selPaddingLeftUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label>右</label>
                            <input name="paddingRightValue" autocomplete="off" class="layui-input"
                                style="width:100px;display:inline;margin:0 10px;"
                                onchange="setPaddingRight(Number.parseFloat(event.target.value))">
                            <div style="width:70px;display:inline-block;">
                                <select name="selPaddingRightUnit" lay-filter="selPaddingRightUnit"
                                    id="selPaddingRightUnit">
                                    <option value="">默认</option>
                                    <option>mm</option>
                                    <option>cm</option>
                                    <option>px</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-colla-item elem-text">
                    <h2 class="layui-colla-title">圆角</h2>
                    <div class="layui-colla-content layui-show">
                        <div style="display: flex;">
                            <div class="layui-form-item">
                                <img src="./icon/radius-top-left.png" width="15">
                                <input name="radiusTopLeftValue" autocomplete="off" class="layui-input"
                                    style="width:50px;display:inline;margin:0 3px;"
                                    onchange="setRadiusTopLeft(Number.parseFloat(event.target.value))">
                                <div style="width:70px;display:inline-block;">
                                    <select name="selRadiusTopLeftUnit" lay-filter="selRadiusTopLeftUnit" id="selRadiusTopLeftUnit">
                                        <option value="">默认</option>
                                        <option>mm</option>
                                        <option>cm</option>
                                        <option>px</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <img src="./icon/radius-top-right.png" width="15">
                                <input name="radiusTopRightValue" autocomplete="off" class="layui-input"
                                    style="width:50px;display:inline;margin:0 3px;"
                                    onchange="setRadiusTopRight(Number.parseFloat(event.target.value))">
                                <div style="width:70px;display:inline-block;">
                                    <select name="selRadiusTopRightUnit" lay-filter="selRadiusTopRightUnit" id="selRadiusTopRightUnit">
                                        <option value="">默认</option>
                                        <option>mm</option>
                                        <option>cm</option>
                                        <option>px</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div style="display: flex;">
                            <div class="layui-form-item">
                                <img src="./icon/radius-bottom-left.png" width="15">
                                <input name="radiusBottomLeftValue" autocomplete="off" class="layui-input"
                                    style="width:50px;display:inline;margin:0 3px;"
                                    onchange="setRadiusBottomLeft(Number.parseFloat(event.target.value))">
                                <div style="width:70px;display:inline-block;">
                                    <select name="selRadiusBottomLeftUnit" lay-filter="selRadiusBottomLeftUnit" id="selRadiusBottomLeftUnit">
                                        <option value="">默认</option>
                                        <option>mm</option>
                                        <option>cm</option>
                                        <option>px</option>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <img src="./icon/radius-bottom-right.png" width="15">
                                <input name="radiusBottomRightValue" autocomplete="off" class="layui-input"
                                    style="width:50px;display:inline;margin:0 3px;"
                                    onchange="setRadiusBottomRight(Number.parseFloat(event.target.value))">
                                <div style="width:70px;display:inline-block;">
                                    <select name="selRadiusBottomRightUnit" lay-filter="selRadiusBottomRightUnit" id="selRadiusBottomRightUnit">
                                        <option value="">默认</option>
                                        <option>mm</option>
                                        <option>cm</option>
                                        <option>px</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script title="设置函数">
        function addElement(elementType) {
            designer.addPageElement(elementType);
        }
        function removeElement() {
            if(designer.selectedTarget)
            designer.removePageElements(designer.selectedTarget);
        }

        function setNumberUnitProperty(value, unit, ...prop) {
            let obj = designer.selectedTarget || designer.document;
            for (let i = 0; i < prop.length - 1; i++) {
                obj = obj[prop[i]];
            }
            obj[prop[prop.length - 1]] = value;
            if (unit)
                obj[prop[prop.length - 1] + 'Unit'] = unit;
            designer.refresh();
        }
        function switchBooleanProperty(...prop) {
            let obj = designer.selectedTarget || designer.document;
            for (let i = 0; i < prop.length - 1; i++) {
                obj = obj[prop[i]];
            }
            obj[prop[prop.length - 1]] = !obj[prop[prop.length - 1]];
            designer.refresh();
        }

        function setContent(content) {
            designer.selectedTarget.content = content;
            designer.refresh();
        }
        function setFontFamily(fontFamily) {
            designer.selectedTarget.font.fontFamily = fontFamily;
            designer.refresh();
        }
        const setFontSize = (fontSize, unit) => setNumberUnitProperty(fontSize, unit, 'font', 'fontSize');
        const switchBold = () => switchBooleanProperty('font', 'isBold');
        const switchItalic = () => switchBooleanProperty('font', 'isItalic');
        const switchUnderline = () => switchBooleanProperty('font', 'isUnderline');

        function setHorizentalAlign(align) {
            designer.selectedTarget.textSetting.horizentalAlign = align;
            designer.refresh();
        }
        function setVerticalAlign(align) {
            designer.selectedTarget.textSetting.verticalAlign = align;
            designer.refresh();
        }
        const switchWrapping = () => switchBooleanProperty('textSetting', 'isWrapping');
        const setWidth = (value, unit) => setNumberUnitProperty(value, unit, 'size', 'w');
        const setHeight = (value, unit) => setNumberUnitProperty(value, unit, 'size', 'h');
        const setX = (value, unit) => setNumberUnitProperty(value, unit, 'position', 'x');
        const setY = (value, unit) => setNumberUnitProperty(value, unit, 'position', 'y');
        const setX1 = (value,unit) => setNumberUnitProperty(value,unit,'point1','x');
        const setX2 = (value,unit) => setNumberUnitProperty(value,unit,'point2','x');
        const setY1 = (value,unit) => setNumberUnitProperty(value,unit,'point1','y');
        const setY2 = (value,unit) => setNumberUnitProperty(value,unit,'point2','y');
        const setLineWidth = (value,unit) => setNumberUnitProperty(value,unit,'lineWidth');
        const switchFitContentWidth = () => switchBooleanProperty('fitContent', 'fitWidth');
        const switchFitContentHeight = () => switchBooleanProperty('fitContent', 'fitHeight');
        const setBorderTopWidth = (value, unit) => setNumberUnitProperty(value, unit, 'border', 'topWidth');
        const setBorderBottomWidth = (value, unit) => setNumberUnitProperty(value, unit, 'border', 'bottomWidth');
        const setBorderLeftWidth = (value, unit) => setNumberUnitProperty(value, unit, 'border', 'leftWidth');
        const setBorderRightWidth = (value, unit) => setNumberUnitProperty(value, unit, 'border', 'rightWidth');
        const setPaddingTop = (value, unit) => setNumberUnitProperty(value, unit, 'padding', 'top');
        const setPaddingBottom = (value, unit) => setNumberUnitProperty(value, unit, 'padding', 'bottom');
        const setPaddingLeft = (value, unit) => setNumberUnitProperty(value, unit, 'padding', 'left');
        const setPaddingRight = (value, unit) => setNumberUnitProperty(value, unit, 'padding', 'right');
        const setRadiusTopLeft = (value,unit) => setNumberUnitProperty(value,unit,'border','borderTopLeftRadiusWidth');
        const setRadiusTopRight = (value,unit) => setNumberUnitProperty(value,unit,'border','borderTopRightRadiusWidth');
        const setRadiusBottomLeft = (value,unit) => setNumberUnitProperty(value,unit,'border','borderBottomLeftRadiusWidth');
        const setRadiusBottomRight = (value,unit) => setNumberUnitProperty(value,unit,'border','borderBottomRightRadiusWidth');
        function setBorderTopStyle(value) {
            designer.selectedTarget.border.topStyle = value;
            designer.refresh();
        }
        function setBorderBottomStyle(value) {
            designer.selectedTarget.border.bottomStyle = value;
            designer.refresh();
        }
        function setBorderLeftStyle(value) {
            designer.selectedTarget.border.leftStyle = value;
            designer.refresh();
        }
        function setBorderRightStyle(value) {
            designer.selectedTarget.border.rightStyle = value;
            designer.refresh();
        }
        function setBorderTopColor(value) {
            designer.selectedTarget.border.topColor = value;
            designer.refresh();
        }
        function setBorderBottomColor(value) {
            designer.selectedTarget.border.bottomColor = value;
            designer.refresh();
        }
        function setBorderLeftColor(value) {
            designer.selectedTarget.border.leftColor = value;
            designer.refresh();
        }
        function setBorderRightColor(value) {
            designer.selectedTarget.border.rightColor = value;
            designer.refresh();
        }
        function setBackgroundColor(value){
            if(designer.selectedTarget){
                designer.selectedTarget.color.backgroundColor = value;
            }else{
                designer.document.backgroundColor = value;
            }
            designer.refresh();
        }
        function setColor(value){
            if(designer.selectedTarget.elementType == 'line'){
                designer.selectedTarget.color = value;
            }else{
                designer.selectedTarget.color.color = value;
            }
            designer.refresh();
        }
        function setLineStyle(value){
            designer.selectedTarget.lineStyle = value;
            designer.refresh();
        }
    </script>
    <script title="UI">

        function setDesignerScale(value){
            designer.designerScale = value;
        }
        function setDesignerScaleUp(){
            const width = document.querySelector('.page-box').offsetWidth;
            setDesignerScale((width + 100) / width * designer.designerScale);
        }
        function setDesignerScaleDown(){
            const width = document.querySelector('.page-box').offsetWidth;
            if(width > 150)
            setDesignerScale((width - 100) / width * designer.designerScale);
        }
        // document.querySelector('.designer-dom').addEventListener('mousewheel',function(evt){
        //     let width = document.querySelector('.page-box').offsetWidth;
        //     if(evt.deltaY > 0 && width > 150){
        //         transformScale = (width - 100) / width * transformScale;
        //         document.querySelector('.designer-dom').style.transform = `scale(${transformScale})`;
        //     }else if(evt.deltaY < 0 ){
        //         transformScale = (width + 100) / width * transformScale;
        //         document.querySelector('.designer-dom').style.transform = `scale(${transformScale})`;
        //     }
        // })
        layui.use(['form', 'element','layer','laytpl'], function () {
            layui.form.on('select(selFont)', data => setFontFamily(data.value));
            layui.form.on('select(selSize)', data => setFontSize(data.value, 'px'));
            layui.form.on('select(selWidthUnit)', data => setWidth(layui.form.val('popup').widthValue, data.value));
            layui.form.on('select(selWidthValue)', data => setWidth(data.value,layui.form.val('popup').selWidthUnit));
            layui.form.on('select(selHeightUnit)', data => setHeight(layui.form.val('popup').heightValue, data.value));
            layui.form.on('checkbox(fitContentWidth)', data => switchFitContentWidth());
            layui.form.on('checkbox(fitContentHeight)', data => switchFitContentHeight());
            layui.form.on('select(selBorderTopWidthUnit)', data => setBorderTopWidth(layui.form.val('popup').borderTopWidthValue, data.value))
            layui.form.on('select(selBorderTopStyle)', data => setBorderTopStyle(data.value))
            layui.form.on('select(selBorderTopColor)', data => setBorderTopColor(data.value))
            layui.form.on('select(selBorderBottomWidthUnit)', data => setBorderBottomWidth(layui.form.val('popup').borderBottomWidthValue, data.value))
            layui.form.on('select(selBorderBottomStyle)', data => setBorderBottomStyle(data.value))
            layui.form.on('select(selBorderBottomColor)', data => setBorderBottomColor(data.value))
            layui.form.on('select(selBorderLeftWidthUnit)', data => setBorderLeftWidth(layui.form.val('popup').borderLeftWidthValue, data.value))
            layui.form.on('select(selBorderLeftStyle)', data => setBorderLeftStyle(data.value))
            layui.form.on('select(selBorderLeftColor)', data => setBorderLeftColor(data.value))
            layui.form.on('select(selBorderRightWidthUnit)', data => setBorderRightWidth(layui.form.val('popup').borderRightWidthValue, data.value))
            layui.form.on('select(selBorderRightStyle)', data => setBorderRightStyle(data.value))
            layui.form.on('select(selBorderRightColor)', data => setBorderRightColor(data.value))
            layui.form.on('select(paddingTopUnit)', data => setPaddingTop(layui.form.val('popup').paddingTopValue, data.value))
            layui.form.on('select(paddingBottomUnit)', data => setPaddingBottom(layui.form.val('popup').paddingBottomValue, data.value))
            layui.form.on('select(paddingLeftUnit)', data => setPaddingLeft(layui.form.val('popup').paddingLeftValue, data.value))
            layui.form.on('select(paddingRightUnit)', data => setPaddingRight(layui.form.val('popup').paddingRightValue, data.value))
            layui.form.on('select(selRadiusTopLeftUnit)', data => setRadiusTopLeft(layui.form.val('popup').radiusTopLeftValue, data.value))
            layui.form.on('select(selRadiusTopRightUnit)', data => setRadiusTopRight(layui.form.val('popup').radiusTopRightValue, data.value))
            layui.form.on('select(selRadiusBottomLeftUnit)', data => setRadiusBottomLeft(layui.form.val('popup').radiusBottomLeftValue, data.value))
            layui.form.on('select(selRadiusBottomRightUnit)', data => setRadiusBottomRight(layui.form.val('popup').radiusBottomRightValue, data.value))
            layui.form.on('select(selColor)',data=>setColor(data.value));
            layui.form.on('select(selBackgroundColor)',data=>setBackgroundColor(data.value));
            layui.form.on('select(selXUnit)',data=>setX(layui.form.val('popup').xValue,data.value));
            layui.form.on('select(selYUnit)',data=>setY(layui.form.val('popup').yValue,data.value));
            layui.form.on('select(selX1Unit)',data=>setX1(layui.form.val('popup').x1Value,data.value));
            layui.form.on('select(selY1Unit)',data=>setY1(layui.form.val('popup').y1Value,data.value));
            layui.form.on('select(selX2Unit)',data=>setX2(layui.form.val('popup').x2Value,data.value));
            layui.form.on('select(selY2Unit)',data=>setY2(layui.form.val('popup').y2Value,data.value));
            layui.form.on('select(selLineWidthUnit)',data=>setLineWidth(layui.form.val('popup').lineWidthValue,data.value));
            layui.form.on('select(selLineStyle)',data=>setLineStyle(data.value));

            const originRender = layui.form.render;
            layui.form.render = function(val){
                originRender.apply(this,val);
                $('dd[lay-value]').each((idx,elem)=>{
                    const color = elem.attributes.getNamedItem('lay-value').value;
                    if(color != 'transparent' && color != 'white')
                    elem.style.color = color;
                })
            }
        })
        // var reportId = $.request('reportId');//报表id
        // var menuId = $.request('menuId');//档案类型id
        // var types = "";//左右备注
        // var reportModel = {};//模板模型
        // var marginObj = {};
        // var fieldList = [];
        // //系统变量的值，这个固定，为了显示和存值的时候方便转换
        // var sysVariableArr = [{ title: "总页数", field: "CurTotalPageCount" }, { title: "总记录数", field: "CurTotalRecordCount" }, { title: "页号", field: "CurPageNO" }];
        // layui.use(['jquery', 'table', 'laytpl'], function () {
        // });
        function renderTextToolbarDom(element) {

        }
        function renderQrcodeToolbarDom(element){

        }
        function renderLineToolbarDom(element){

        }
        function renderTextPopupDom(element) {
            if(designer.selectedTarget != element)
                return;
            const obj = element;
            const formData = {
                    widthValue: obj.size.w,
                    selWidthUnit: obj.size.wUnit,
                    heightValue: obj.size.h,
                    selHeightUnit: obj.size.hUnit,
                    selFont:obj.font.fontFamily,
                    selSize:obj.font.fontSize,
                    xValue: obj.position.x,
                    selXUnit: obj.position.xUnit,
                    yValue: obj.position.y,
                    selYUnit: obj.position.yUnit,
                    content: obj.content,
                    fitContentWidth: obj.fitContent.fitWidth,
                    fitContentHeight: obj.fitContent.fitHeight,
                    borderTopWidthValue: obj.border.topWidth,
                    selBorderTopWidthUnit: obj.border.topWidthUnit,
                    selBorderTopStyle: obj.border.topStyle,
                    borderTopColor:obj.border.topColor,
                    selborderTopColor: obj.border.topColor,
                    borderBottomWidthValue: obj.border.bottomWidth,
                    selBorderBottomWidthUnit: obj.border.bottomWidthUnit,
                    selBorderBottomStyle: obj.border.bottomStyle,
                    borderBottomColor:obj.border.bottomColor,
                    selborderBottomColor: obj.border.bottomColor,
                    borderLeftWidthValue: obj.border.leftWidth,
                    selBorderLeftWidthUnit: obj.border.leftWidthUnit,
                    selBorderLeftStyle: obj.border.leftStyle,
                    borderLeftColor:obj.border.leftColor,
                    selborderLeftColor: obj.border.leftColor,
                    borderRightWidthValue: obj.border.rightWidth,
                    selBorderRightWidthUnit: obj.border.rightWidthUnit,
                    selBorderRightStyle: obj.border.rightStyle,
                    borderRightColor:obj.border.rightColor,
                    selborderRightColor: obj.border.rightColor,
                    paddingTopValue: obj.padding.top,
                    selPaddingTopUnit: obj.padding.topUnit,
                    paddingBottomValue: obj.padding.bottom,
                    selPaddingBottomUnit: obj.padding.bottomUnit,
                    paddingLeftValue: obj.padding.left,
                    selPaddingLeftUnit: obj.padding.leftUnit,
                    paddingRightValue: obj.padding.right,
                    selPaddingRightUnit: obj.padding.rightUnit,
                    radiusTopLeftValue:obj.border.borderTopLeftRadiusWidth,
                    selRadiusTopLeftUnit:obj.border.borderTopLeftRadiusWidthUnit,
                    radiusTopRightValue:obj.border.borderTopRightRadiusWidth,
                    selRadiusTopRightUnit:obj.border.borderTopRightRadiusWidthUnit,
                    radiusBottomLeftValue:obj.border.borderBottomRightRadiusWidth,
                    selRadiusBottomLeftUnit:obj.border.borderBottomLeftRadiusWidthUnit,
                    radiusBottomRightValue:obj.border.borderBottomRightRadiusWidth,
                    selRadiusBottomRightUnit:obj.border.borderBottomRightRadiusWidthUnit,
                    color:obj.color.color,
                    backgroundColor:obj.color.backgroundColor,
            }
            layui.form.val('popup', formData);
            
        }
        function renderQrcodePopupDom(element){
            if(designer.selectedTarget != element)
                return;
            const obj = element;
            const formData = {
                    widthValue: obj.size.l,
                    selWidthValue:obj.size.l,
                    selWidthUnit: obj.size.lUnit,
                    xValue: obj.position.x,
                    selXUnit: obj.position.xUnit,
                    yValue: obj.position.y,
                    selYUnit: obj.position.yUnit,
                    content: obj.content,
                    color:obj.color.color,
                    backgroundColor:obj.color.backgroundColor,
            }
            layui.form.val('popup', formData);
        }
        function renderLinePopupDom(element){
            if(designer.selectedTarget != element)
                return;
            const obj = element;
            const formData = {
                    lineWidthValue: obj.lineWidth,
                    selLineWidthUnit: obj.lineWidthUnit,
                    selLineStyle:obj.lineStyle,
                    x1Value: obj.point1.x,
                    selX1Unit: obj.point1.xUnit,
                    y1Value: obj.point1.y,
                    selY1Unit: obj.point1.yUnit,
                    x2Value: obj.point2.x,
                    selX2Unit: obj.point2.xUnit,
                    y2Value: obj.point2.y,
                    selY2Unit: obj.point2.yUnit,
                    color:obj.color,
            }
            layui.form.val('popup', formData);
        }
        function renderPagePopupDom(){
            if(designer.selectedTarget != null)
                return;
            const obj = designer.document;
            const formData = {
                widthValue: obj.size.w,
                selWidthUnit: obj.size.wUnit,
                heightValue: obj.size.h,
                selHeightUnit: obj.size.hUnit,
                backgroundColor:obj.backgroundColor,
            }
            layui.form.val('popup', formData);
        }
        function afterPageRender(){
            renderPagePopupDom();
            $('.elem-page,.elem-text,.elem-qrcode,.elem-line').hide();
            if(designer.selectedTarget){
                $('.elem-'+designer.selectedTarget.elementType).show();
            }else{
                $('.elem-page').show();
            }

            layui.form.val('toolbar',{scale:designer.designerScale.toFixed(2) * 100});
        }
    </script>

    <script>
        function insertFieldToContent(){
            layui.layer.open({
                title:'插入域',
                type:1,
                content:layui.laytpl(dialogInsertField.innerHTML).render({}),
                area:['400px','500px']
            })
        }
        function confirmInsertFieldToContent(field){
            const selectionEnd = textareaContent.value.length -  textareaContent.selectionEnd;
            textareaContent.value = textareaContent.value.substring(0,textareaContent.selectionStart)+`[#${field}#]`+textareaContent.value.substring(textareaContent.selectionEnd);
            setContent(textareaContent.value);
            textareaContent.focus();
            textareaContent.setSelectionRange(textareaContent.value.length- selectionEnd,textareaContent.value.length-selectionEnd);
        }
        const fields = {
            docno:'档号',
            title:'题名',
            saveperiod:'机构问题',
            other:'凑数的'
        }
        const data = {
            docno:'WS-C001-0002-0100',
            title:'这是一个测试题名，非常非常非常长，长得十分带劲'
        }
        function previewDocument(){
            var page = designer.save().toSimpleObject();
            layui.layer.open({
                type:2,
                title:'报表预览',
                content:'./preview.html',
                area:['90%','90%'],
                success:function(layero, index){
                    var body = layer.getChildFrame('body', index);
                    var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
                    iframeWin.render(JSON.stringify(page),data);
                }
            })
        }
    </script>
    <script type="text/html" id="dialogInsertField">
        <div style="padding: 10px 0;">

            <div class="layui-form">
                <div class="layui-form-item">
                    <label class="layui-form-label">字段</label>
                    <div class="layui-input-block">
                        {{# layui.each(fields,function(field,title){ }}
                        <button class="layui-btn layui-btn-sm" onclick="confirmInsertFieldToContent('{{field}}')">{{title}}</button>
                        {{# }) }}
                    </div>
                </div>
            </div>
        </div>
    </script>
</body>

</html>